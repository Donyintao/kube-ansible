####
## kubernetes system config
##
## The following values are used to configure the kube-apiserver
##
####
## The address on the local server to listen to.
KUBE_API_ADDRESS="--advertise-address=0.0.0.0 --bind-address=0.0.0.0"
#
## The port on the local server to listen on.
KUBE_API_PORT="--secure-port=6443"
#
## Comma separated list of nodes in the etcd cluster
KUBE_ETCD_SERVERS="--etcd-servers={{ ETCD_CLUSTER_ADDRESS }}"
#
## Address range to use for services
KUBE_SERVICE_ADDRESSES="--service-cluster-ip-range={{ KUBE_SERVICE_CIDR }}"
#
## default admission control policies
KUBE_ADMISSION_CONTROL="--enable-admission-plugins=Initializers,NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,ResourceQuota"
#
## Add your own!
KUBE_API_ARGS="--event-ttl=1h \
               --apiserver-count=3 \
               --audit-log-maxage=30 \
               --audit-log-maxbackup=3 \
               --audit-log-maxsize=100 \
               --audit-log-path=/var/log/audit.log \
               --anonymous-auth=false \
               --authorization-mode=Node,RBAC \
               --enable-swagger-ui=true \
               --storage-backend=etcd3 \
               --service-node-port-range={{ KUBE_PORT_RANGE }} \
               --requestheader-allowed-names \
               --requestheader-group-headers=X-Remote-Group \
               --requestheader-username-headers=X-Remote-User \
               --log-dir={{ KUBE_LOGS_PATH }}/kube-apiserver \
               --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname \
               --client-ca-file={{ KUBE_HOME_PATH }}/etc/ssl/ca.pem \
               --service-account-key-file={{ KUBE_HOME_PATH }}/etc/ssl/ca-key.pem \
               --tls-cert-file={{ KUBE_HOME_PATH }}/etc/ssl/kube-apiserver.pem \
               --tls-private-key-file={{ KUBE_HOME_PATH }}/etc/ssl/kube-apiserver-key.pem \
               --etcd-cafile={{ KUBE_HOME_PATH }}/etc/ssl/ca.pem \
               --etcd-certfile={{ KUBE_HOME_PATH }}/etc/ssl/kube-apiserver.pem \
               --etcd-keyfile={{ KUBE_HOME_PATH }}/etc/ssl/kube-apiserver-key.pem"
